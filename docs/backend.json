{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile in the Staylo application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "First name of the user."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the user."
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the user."
        },
        "dateJoined": {
          "type": "string",
          "description": "Date and time when the user joined the platform.",
          "format": "date-time"
        },
        "lastLogin": {
          "type": "string",
          "description": "Date and time of the user's last login.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "firstName",
        "lastName"
      ]
    },
    "Hotel": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Hotel",
      "type": "object",
      "description": "Represents a hotel listed on the Staylo platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Hotel entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the hotel."
        },
        "address": {
          "type": "string",
          "description": "Address of the hotel."
        },
        "city": {
          "type": "string",
          "description": "City where the hotel is located."
        },
        "state": {
          "type": "string",
          "description": "State where the hotel is located."
        },
        "country": {
          "type": "string",
          "description": "Country where the hotel is located."
        },
        "description": {
          "type": "string",
          "description": "Description of the hotel."
        },
        "rating": {
          "type": "number",
          "description": "Average rating of the hotel (e.g., 4.5 stars)."
        },
        "amenities": {
          "type": "array",
          "description": "A list of amenities offered by the hotel.",
          "items": {
            "type": "string"
          }
        },
        "imageUrls": {
          "type": "array",
          "description": "URLs of images showcasing the hotel.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "address",
        "city",
        "state",
        "country"
      ]
    },
    "Booking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Booking",
      "type": "object",
      "description": "Represents a booking made by a user for a hotel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Booking entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Booking)"
        },
        "hotelId": {
          "type": "string",
          "description": "Reference to Hotel. (Relationship: Hotel 1:N Booking)"
        },
        "checkInDate": {
          "type": "string",
          "description": "Check-in date for the booking.",
          "format": "date-time"
        },
        "checkOutDate": {
          "type": "string",
          "description": "Check-out date for the booking.",
          "format": "date-time"
        },
        "numberOfGuests": {
          "type": "number",
          "description": "Number of guests for the booking."
        },
        "totalPrice": {
          "type": "number",
          "description": "Total price of the booking."
        },
        "bookingDate": {
          "type": "string",
          "description": "Date and time when the booking was made.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Status of the booking (e.g., confirmed, cancelled)."
        }
      },
      "required": [
        "id",
        "userId",
        "hotelId",
        "checkInDate",
        "checkOutDate",
        "numberOfGuests",
        "totalPrice",
        "bookingDate",
        "status"
      ]
    },
    "Destination": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Destination",
      "type": "object",
      "description": "Represents a travel destination.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Destination entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the destination (e.g., Delhi, Mumbai)."
        },
        "description": {
          "type": "string",
          "description": "Description of the destination."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image representing the destination."
        },
        "hotelIds": {
          "type": "array",
          "description": "References to Hotels. (Relationship: Destination 1:N Hotel)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "imageUrl"
      ]
    },
    "Review": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Review",
      "type": "object",
      "description": "Represents a review given by a user for a hotel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Review entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Review)"
        },
        "hotelId": {
          "type": "string",
          "description": "Reference to Hotel. (Relationship: Hotel 1:N Review)"
        },
        "rating": {
          "type": "number",
          "description": "Rating given by the user (e.g., 1 to 5 stars)."
        },
        "comment": {
          "type": "string",
          "description": "Comment provided by the user as part of the review."
        },
        "reviewDate": {
          "type": "string",
          "description": "Date and time when the review was submitted.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "hotelId",
        "rating",
        "comment",
        "reviewDate"
      ]
    },
    "Offer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Offer",
      "type": "object",
      "description": "Represents a promotional offer or discount.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Offer entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the offer (e.g., Flat 30% OFF)."
        },
        "description": {
          "type": "string",
          "description": "Description of the offer."
        },
        "discountPercentage": {
          "type": "number",
          "description": "Discount percentage offered."
        },
        "startDate": {
          "type": "string",
          "description": "Start date of the offer.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "End date of the offer.",
          "format": "date-time"
        },
        "hotelIds": {
          "type": "array",
          "description": "References to Hotels. (Relationship: Offer N:N Hotel)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "startDate",
        "endDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/userProfiles/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information. The 'userId' is used to identify the user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/hotels/{hotelId}",
        "definition": {
          "entityName": "Hotel",
          "schema": {
            "$ref": "#/backend/entities/Hotel"
          },
          "description": "Stores hotel information.",
          "params": [
            {
              "name": "hotelId",
              "description": "The unique identifier for the hotel."
            }
          ]
        }
      },
      {
        "path": "/userProfiles/{userId}/bookings/{bookingId}",
        "definition": {
          "entityName": "Booking",
          "schema": {
            "$ref": "#/backend/entities/Booking"
          },
          "description": "Stores booking information for a specific user. 'userId' and 'bookingId' are used to identify the booking.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user who made the booking."
            },
            {
              "name": "bookingId",
              "description": "The unique identifier for the booking."
            }
          ]
        }
      },
      {
        "path": "/destinations/{destinationId}",
        "definition": {
          "entityName": "Destination",
          "schema": {
            "$ref": "#/backend/entities/Destination"
          },
          "description": "Stores destination information.",
          "params": [
            {
              "name": "destinationId",
              "description": "The unique identifier for the destination."
            }
          ]
        }
      },
      {
        "path": "/userProfiles/{userId}/reviews/{reviewId}",
        "definition": {
          "entityName": "Review",
          "schema": {
            "$ref": "#/backend/entities/Review"
          },
          "description": "Stores review information for a specific user. 'userId' and 'reviewId' are used to identify the review.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user who wrote the review."
            },
            {
              "name": "reviewId",
              "description": "The unique identifier for the review."
            }
          ]
        }
      },
      {
        "path": "/offers/{offerId}",
        "definition": {
          "entityName": "Offer",
          "schema": {
            "$ref": "#/backend/entities/Offer"
          },
          "description": "Stores offer information.",
          "params": [
            {
              "name": "offerId",
              "description": "The unique identifier for the offer."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure authorization independence and support the required query capabilities (QAPs) by adhering to the principles of denormalization and structural segregation. User profiles are stored in a dedicated collection (`/userProfiles`) for easy management and access. Hotels and Destinations are stored in their collections, allowing for global listing and searching. Bookings and Reviews are stored as subcollections under the respective user's profile (`/userProfiles/{userId}/bookings` and `/userProfiles/{userId}/reviews`) to ensure clear ownership and simplified security rules based on user ID. Offers are stored in a dedicated collection (`/offers`).\n\n**Authorization Independence:**\n\n*   The structure promotes authorization independence by avoiding hierarchical authorization dependencies. For instance, bookings and reviews are stored under the user's profile, eliminating the need to fetch parent document data for authorization. The `userId` is inherently available in the path.\n\n**QAPs Support:**\n\n*   The structure supports secure `list` operations by segregating data based on ownership and type. Listing bookings or reviews is scoped to the specific user's subcollections, preventing unauthorized access to other users' data.\n\n*   The global collections (`/hotels`, `/destinations`, `/offers`) allow for efficient listing and filtering across all entities without needing to query subcollections, ensuring scalability and performance.\n\nThis design enforces clear data ownership, simplifies security rules, and optimizes query performance, aligning with the core design principles."
  }
}